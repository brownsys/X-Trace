<html>
<head>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31064652-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type="text/javascript" src="lib/d3/d3.v3.min.js"></script>
<script type="text/javascript" src="lib/jQuery/jquery-1.9.0.js"></script>
<script type="text/javascript" src="lib/jQuery/jquery.tipsy.js"></script>
<script type="text/javascript" src="lib/jQuery/jquery.contextMenu.js"></script>
<script type="text/javascript" src="lib/dagre/dagre.js"></script>
<script type="text/javascript" src="js/Minimap.js"></script>
<script type="text/javascript" src="js/MinimapZoom.js"></script>
<script type="text/javascript" src="js/DirectedAcyclicGraph.js"></script>
<script type="text/javascript" src="js/List.js"></script>
<script type="text/javascript" src="js/Selectable.js"></script>
<script type="text/javascript" src="js/Graph.js"></script>
<script type="text/javascript" src="js/History.js"></script>
<script type="text/javascript" src="js/Tooltip.js"></script>
<script type="text/javascript" src="js/ContextMenu.js"></script>
<script type="text/javascript" src="js/xtrace_utils.js"></script>
<script type="text/javascript" src="js/xtrace_dagre.js"></script>
<link href="stylesheets/xtrace.css" rel="stylesheet" type="text/css">
<link href="stylesheets/tipsy.css" rel="stylesheet" type="text/css" />
<link href="stylesheets/jquery.contextMenu.css" rel="stylesheet" type="text/css" />
<svg width=0 height=0>
  <defs>
    <marker id="arrowhead"
            viewBox="0 0 10 10"
            refX="0"
            refY="5"
            markerUnits="strokeWidth"
            markerWidth="4"
            markerHeight="5"
            orient="auto"
            style="fill: #333">
      <path d="M 0 0 L 10 5 L 0 10 z"></path>
    </marker>
  </defs>
</svg>
<script>
window.onload = function() {    
    var trace_id = getParameter("id");
    var lightweight = getParameter("lightweight");
	var callback = function(data) {
		console.log("Reports received, accessible as window.data", data);
		window.data = data;
		//window.xtrace = drawXTraceGraph(document.body, data[0].reports, lightweight=="true");
	};
	var errback = function(message, error) {
		console.log("Error retrieving reports", error);
	};
    if (trace_id.indexOf(".json")!=-1) {
        console.info("Loading reports from JSON file", trace_id)
        d3.json(trace_id, callback);
    } else if (trace_id!=""){
        console.info("Retrieving from X-Trace:", trace_id);
        getReports(trace_id, callback, errback);
    } else {
        document.body.appendChild(document.createTextNode("No trace ID or JSON file specified"));
    }
}
</script>
</head>
<body width="100%" height="100%" style="margin: 0"></body>
</html>